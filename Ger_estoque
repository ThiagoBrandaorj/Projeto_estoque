lista_estoque = []
lista_estoque_valores = []
lista_estoque_codigos = []
escolha = None
qtd = 0
cod_item = 0
desc_item = None
valor_item = 0
cod_item_maior_valor = 0
valor_item_mais_valioso = 0
indice = 0
escolha_2 = None
certeza = None

def saldo(codigo , lista):
  retorno = 0
  codigo = int(codigo)
  for i in lista:
    if codigo == i:
      retorno += 1
  return retorno

def testa_cod_item(cod):
    soma_dig_cod = 0
    cod = str(cod)
    for dig in cod:
      dig = int(dig)
      soma_dig_cod += dig
    cod = int(cod)
    if soma_dig_cod > 30 and soma_dig_cod < 100:
      return True
    else:
      return False

def calcula_media(lista , lista_2):
    contador = 0
    soma_valores = 0
    for count in lista:
      contador += 1
    for valor in lista_2:
      soma_valores += valor
    media = round(soma_valores / contador, 2)
    return media

# está com erro
###########################################
def exclusao(cod , lista_1 , lista_2, lista_3):
  cod = int(cod)
  def exclusao_interna(cod , lista_2):
    indice = 0
    for i in lista_2:
      if i == cod:
        m = indice
      indice += 1
    return m
  item = lista_1.pop(exclusao_interna(cod , lista_2))
  lista_3.pop(exclusao_interna(cod , lista_2))
  lista_2.remove(cod)
  return item



# loop infinito inicialização
while True:
  print('Bem vindo ao Estoque do sistema SisLoja')
  escolha = input(
    'Você deseja incluir ou excluir algum item do estoque ? : ').lower()
  if escolha == 'incluir':
    qtd = int(input('Quantos itens você deseja incluir no estoque: '))
    if qtd == 0:
      if input('Digite uma quntidade válida , digite "0" '
    'para voltar á tela principal: ') == '0':
        continue

    elif qtd == 1:
      item = input('Escreva o item: ')
      cod_item = int(input('Digite o código do item: '))
      if testa_cod_item(cod_item):
        des_item = input('Inclua uma descrição do item: ')
        valor_item = float(input('Digite o valor do item: '))
        lista_estoque.append(item)
        lista_estoque_valores.append(valor_item)
        lista_estoque_codigos.append(cod_item)
      else:
        if input('Digite um código válido , digite "0" '
    'para voltar á tela principal: ') == '0':
          continue
      if valor_item > valor_item_mais_valioso:
        valor_item_mais_valioso = valor_item
        cod_item_maior_valor = cod_item
      print('-' * 40)
      print(
        'Valor médio dos itens cadastrados:'
        f' R$ {calcula_media(lista_estoque,lista_estoque_valores)}')
      print(
        f'Item de maior valor cadastrado: {cod_item_maior_valor} , valor R$ {valor_item_mais_valioso}'
      )
      print('-' * 40)
      if input('Tecle 0 para retornar à tela principal') == 0:
        continue

    else:
      for i in range(1, qtd + 1):
        item = input(f'Digite o item {i}: ')
        cod_item = int(input(f'Digite o código do item {i}: '))
        if testa_cod_item(cod_item):
          des_item = input(f'Inclua uma descrição do item {i}: ')
          valor_item = float(input(f'Digite o valor do item {i}: '))
          lista_estoque.append(item)
          lista_estoque_valores.append(valor_item)
          lista_estoque_codigos.append(cod_item)
        else:
          if input('Digite um código válido , digite "0" '
          'para voltar á tela principal: ') == '0':
            continue
        if valor_item > valor_item_mais_valioso:
          valor_item_mais_valioso = valor_item
          cod_item_maior_valor = cod_item
      print('-' * 40)
      print(
        'Valor médio dos itens cadastrados:'
        f' R$ {calcula_media(lista_estoque, lista_estoque_valores)}')
      print(
        f'Item de maior valor cadastrado:'
        f' código =  {cod_item_maior_valor} , valor R$ {valor_item_mais_valioso}' )
      print('-' * 40)
      if input('Tecle 0 para retornar à tela principal:   ') == 0:
        continue
  elif escolha == 'excluir':
    cod_item = input(
        'Digite o código do item que deseja excluir do estoque:  ')
    certeza = input('TEM CERTEZA QUE DESEJA EXCLUIR O ITEM ?   ').lower()
    if certeza == 'sim':
        if saldo(cod_item , lista_estoque_codigos) > 0:
            item = exclusao(cod_item , lista_estoque , lista_estoque_codigos , lista_estoque_valores)
            print('OPERAÇÃO REALIZADA COM SUCESSO')
            escolha_2 = input(
            'Você deseja excluir mais algum item da lista ?  ').lower()
            if escolha_2 == 'sim':
              continue
            elif escolha_2 == 'nao':
             cod_item = str(cod_item)
             print('-' * 40)
             print('RELÁTORIO DE ITENS EXCLUÍDOS ')
             print('  ITEM              SALDO')
             print(f'{item}            {saldo(cod_item , lista_estoque_codigos)} ')
             print('-' * 40)
             if input('Tecle 0 para retornar à tela principal:   ') == 0:
              continue
        else:
          if input('O item não tem saldo em estoque'
        ' , digite "0"para voltar á tela principal:') == '0':
           continue
          
    elif certeza == 'nao':
      continue

  else:
    if input('Digite uma escolha válida , digite "0"'
    ' , para voltar á tela principal: ') == '0':
      continue
